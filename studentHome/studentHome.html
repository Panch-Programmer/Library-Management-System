<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="studentHome.css">
    <title>Student Home</title>
</head>

<body>
    <header>
        <h1>Student Home</h1>
        <div id="studentIdDisplay"></div> <button type="button" id="logOut">Log Out</button>
        
    </header>
    <main>
        <section id = "t"> <h2>Welcome to your DashBoard! </h2> <p>Please select an option to continue.<p> </section>
        
        <section id = "t1">
            <input class="btn" type="submit" value=" Search " id="searchButton">
            <input class="btn" type="submit" value=" Loans " id="loan_button">
            <input class="btn" type="submit" value=" Requests " >
            <input class="btn" type="submit" value=" Fines ">
        </section>
    </main>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDocs, addDoc, query, where } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js";

        const firebaseConfig = {
                apiKey: "AIzaSyCkguRAkkhEfu4JIjFgh7lrDbcv5jQ21ps",
                authDomain: "lms1-2fdcb.firebaseapp.com",
                projectId: "lms1-2fdcb",
                storageBucket: "lms1-2fdcb.appspot.com",
                messagingSenderId: "952940918932",
                appId: "1:952940918932:web:9f757d9f2d77e445049c81"
            };
        const app = initializeApp(firebaseConfig);

        const auth = getAuth(app);
        const user = auth.currentUser;

        const db = getFirestore(app);
        const colRef = collection(db, 'student');

        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, see docs for a list of available properties
                // https://firebase.google.com/docs/reference/js/auth.user
                document.getElementById("studentIdDisplay").textContent = user.email;
                // ...
            } else {
                // User is signed out
                console.log('no log in')
                // ...
            }
        });
        const logOut = document.getElementById('logOut')
        logOut.addEventListener('click', () => {
            signOut(auth).then(() => {
                alert("Logged Out Successfully")
                console.log("logged out")
                window.open('../studentLogin/studentLogin.html', '_self')
                // Sign-out successful.
            }).catch((error) => {
                // An error happened.
            });
        })
        

        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    //entry.target.classList.remove('notShow');
                    entry.target.classList.add('show');
                } else {
                    entry.target.classList.remove('show');
                }
            });
        });

        const hiddenElements = document.querySelectorAll('.btn');
        hiddenElements.forEach((el) => {
            //el.target.classList.add('notShow')
            observer.observe(el)});

        const button1 = document.querySelector("#searchButton");
        button1.onclick = goToSearchPage;

        function goToSearchPage() {
            const path = "../student_search/student_Search.html";
            window.open(path, "_self");
        }

        let loan = document.getElementById("loan_button");
        function goToLoansPage() {
            const path = "../Student_loan/Student_loan.html";
            window.open(path, "_self");
        }

        loan.onclick = goToLoansPage;

        
    </script>
</body>

</html>
